% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/DEAOnMetaGenes.R, R/defineMetaGenes.R,
%   R/metaGenes-plot.R, R/pcaGenesCoex.R
\name{DEAOnMetaGenes}
\alias{DEAOnMetaGenes}
\alias{defineMetaGenes}
\alias{metaGenesPlot}
\alias{pcaGenesCoex}
\title{Meta-genes: definition and usage}
\usage{
DEAOnMetaGenes(objCOTAN, metaGenes)

defineMetaGenes(
  points,
  maxDist = 15,
  minSize = 25L,
  maxSize = 100L,
  distance = "cosine",
  permutation = FALSE
)

metaGenesPlot(x, y, metaGenes)

pcaGenesCoex(
  objCOTAN,
  pcaDim,
  varThreshold = 1.5,
  idThreshold = 1.25,
  actCoexSpace = FALSE
)
}
\arguments{
\item{objCOTAN}{a \code{COTAN} object}

\item{metaGenes}{a \code{list} of \emph{meta-genes}, such as the result of
\code{\link[=defineMetaGenes]{defineMetaGenes()}}.}

\item{points}{a \code{matrix} where each point is presented as a row}

\item{maxDist}{a maximum distance between two points inside a single
\emph{meta-gene}}

\item{distance}{the distance method to use. Default is \code{"euclidian"}}

\item{x}{an \code{array} giving the first coordinate of the points}

\item{y}{an \code{array} giving the second coordinate of the points}

\item{pcaDim}{the dimension of the \strong{PCA} vectors}

\item{varThreshold}{genes with \strong{GDI} less than \code{varThreshold} are excluded
from driving features (\code{genesCoex} columns)}

\item{idThreshold}{genes with \strong{GDI} less than \code{idThreshold} are excluded
from the genes' list (\code{genesCoex} rows)}

\item{actCoexSpace}{Boolean, when \code{TRUE} the transformation to coex space is
applied}

\item{minSize:}{the minimum size of a \emph{meta-gene}}

\item{maxSize:}{the maximum size of a \emph{meta-gene}}

\item{permute:}{a Boolean. When \code{FALSE} the points are used in the given
order as potential meta-genes centers, otherwise a random a permutation is
performed}
}
\value{
\code{DEAOnMetaGenes()} returns a \code{list} with two objects:
\itemize{
\item "coex"    - the co-expression \code{data.frame} for the cells against each
\emph{meta-gene}
\item "p-value" - the corresponding p-values \code{data.frame}
}

\code{defineMetaGenes()}returns a \code{list} of \emph{meta-genes}, each named after
its center gene. A \emph{meta-gene} is an array of gene names, thus making this
similar to a \link{ClusterList}

\code{metaGenesPlot()} returns a \code{list} with:
\itemize{
\item "plot" the wanted \code{ggplot}
\item "overlapping" an \code{array} that for each point gives how many
\emph{meta-genes} it belongs to; centers are returned with the highest value
}

\code{pcaGenesCoex()} returns a \code{list} with two elements:
\itemize{
\item \code{"pca"} the PCA
\item \code{"varExplained"} the variance explained for each component
\item \code{"rotation"} the PCA rotation matrix
}
}
\description{
A \emph{meta-gene} is a small group of genes deemed similar according
to some given distance. This grouping is intended to make less noisy and
more robust any procedure that would try to cluster cells based on coex
information
}
\details{
\code{DEAOnMetaGenes()} is used to run the \emph{Differential Expression
Analysis} using the \code{COTAN} contingency tables on each given \emph{meta-gene}

\code{defineMetaGenes()} groups together \emph{similar} genes into
\emph{meta-genes} according to the given distance. Usually the distance is based
on some function of the PCA of the genes

\code{metaGenesPlot()} shows the overlap of the points in the
\emph{meta-genes} in the given \eqn{(x, y)} space (usually the PCA).
The union of all names in the \emph{meta-genes} must be a subset of the names in
the coordinates

\code{pcaGenesCoex()} calculates the \strong{PCA} of \code{genesCoex}, selecting
the genes with highest \strong{GDI} as features
}
\examples{
# pca <- pcaGenesCoex()
# metaGenes <- defineMetaGenes(pca, )
# metaGenesPlot(pca[, 1L], pca[, 2L], metaGenes)
# DEAOnMetaGenes()

}
